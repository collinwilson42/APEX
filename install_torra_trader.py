import base64, os
data = base64.b64decode("IiIiClRPUlJBIFRSQURFUiB2My4wIOKAlCBUaHJlZS1MYXllciBTY29yaW5nIEVuZ2luZQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KU2VlZCAyMTogRGV0ZXJtaW5pc3RpYyArIEludGVycHJldGl2ZSArIFZhbGlkYXRlZAoKVGhyZWUtbGF5ZXIgc2NvcmluZyBwaXBlbGluZToKICBMYXllciAxICg4MCUpOiBEZXRlcm1pbmlzdGljIHRlY2huaWNhbCBzY29yZXMgZnJvbSBpbnRlbGxpZ2VuY2UgREIKICAgICAgICAgICAgICAgICBSU0ksIE1BQ0QsIEJvbGxpbmdlciwgU3RvY2hhc3RpYywgQURYLCBJY2hpbW9rdSwgRmlib25hY2NpCiAgICAgICAgICAgICAgICAgU2FtZSBkYXRhIOKGkiBzYW1lIHNjb3JlLiBBbHdheXMuCiAgTGF5ZXIgMiAoMjAlKTogQ2xhdWRlIGludGVycHJldHMgaW5kaWNhdG9ycyArIGNoYXJ0IHNjcmVlbnNob3QKICAgICAgICAgICAgICAgICBSZXR1cm5zIHNtYWxsIGFkanVzdG1lbnRzICgtMC4zIHRvICswLjMpIHdpdGggdGV4dCByYXRpb25hbGUKICBMYXllciAzOiAgICAgICBDb25zaXN0ZW5jeSB2YWxpZGF0aW9uIOKAlCByZWplY3QgTDIgaWYgcmF0aW9uYWxlIGNvbnRyYWRpY3RzIHNjb3JlCgpQZXIgdGljazogTDEgdGVjaCBzY29yZXMg4oaSIHNjcmVlbnNob3Qg4oaSIEwyIENsYXVkZSBpbnRlcnByZXQg4oaSIEwzIHZhbGlkYXRlIOKGkiBibGVuZCDihpIgQVRIIOKGkiBEQiDihpIgZXhlY3V0ZQoKVGhlIERBVEFCQVNFIGlzIHN0aWxsIHRoZSBicmFpbiAoaW5zdGFuY2VfZGF0YWJhc2Uuc2F2ZV9zZW50aW1lbnQoKSk6CiAgLSBBcHBsaWVzIHByb2ZpbGUgd2VpZ2h0cyDihpIgY29tcG9zaXRlCiAgLSBCbGVuZHMgY3Jvc3MtdGltZWZyYW1lIGNvbnNlbnN1cwogIC0gQ2hlY2tzIHRocmVzaG9sZHMg4oaSIEJVWSAvIFNFTEwgLyBIT0xECgpTY2hlZHVsZSAobWF0Y2hlcyBzZW50aW1lbnRfZW5naW5lKToKICAxNW0gYW5hbHlzaXM6IFg6MDEsIFg6MTYsIFg6MzEsIFg6NDYKICAxaCAgYW5hbHlzaXM6IFg6MDIKClVzYWdlOgogIHB5dGhvbiB0b3JyYV90cmFkZXIucHkgLS1pbnN0YW5jZS1pZCB4YXVqMjZfc2ltX2FiYzEyMzQ1CiAgcHl0aG9uIHRvcnJhX3RyYWRlci5weSAtLWluc3RhbmNlLWlkIHhhdWoyNl9zaW1fYWJjMTIzNDUgLS1vbmNlCiIiIgoKaW1wb3J0IG9zCmltcG9ydCBzeXMKaW1wb3J0IGpzb24KaW1wb3J0IHRpbWUKaW1wb3J0IGJhc2U2NAppbXBvcnQgc2lnbmFsCmltcG9ydCBsb2dnaW5nCmltcG9ydCBhcmdwYXJzZQpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQpmcm9tIHR5cGluZyBpbXBvcnQgT3B0aW9uYWwsIERpY3QKCiMg4pSA4pSAIEltcG9ydHMg4pSA4pSACnRyeToKICAgIGltcG9ydCBhbnRocm9waWMKICAgIEhBU19BTlRIUk9QSUMgPSBUcnVlCmV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgIEhBU19BTlRIUk9QSUMgPSBGYWxzZQogICAgcHJpbnQoIltXQVJOXSBhbnRocm9waWMgbm90IGluc3RhbGxlZDogcGlwIGluc3RhbGwgYW50aHJvcGljIikKCnRyeToKICAgIGltcG9ydCBtc3MKICAgIGltcG9ydCBtc3MudG9vbHMKICAgIEhBU19NU1MgPSBUcnVlCmV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgIEhBU19NU1MgPSBGYWxzZQogICAgcHJpbnQoIltXQVJOXSBtc3Mgbm90IGluc3RhbGxlZDogcGlwIGluc3RhbGwgbXNzIikKCkJBU0VfRElSID0gb3MucGF0aC5kaXJuYW1lKG9zLnBhdGguYWJzcGF0aChfX2ZpbGVfXykpCnN5cy5wYXRoLmluc2VydCgwLCBCQVNFX0RJUikKCmZyb20gc2NvcmluZ19ydWJyaWMgaW1wb3J0IGJ1aWxkX3Njb3JpbmdfcHJvbXB0LCBidWlsZF9pbnRlcnByZXRpdmVfcHJvbXB0CmZyb20gY29uZmlnIGltcG9ydCBTWU1CT0xfREFUQUJBU0VTCmZyb20gYXRoX2NhbGN1bGF0b3IgaW1wb3J0IGNhbGN1bGF0ZV9hdGhfc2NvcmUKZnJvbSB0ZWNobmljYWxfY2FsY3VsYXRvciBpbXBvcnQgY2FsY3VsYXRlX3RlY2huaWNhbF9zY29yZXMKCnRyeToKICAgIGZyb20gaW5zdGFuY2VfZGF0YWJhc2UgaW1wb3J0IGdldF9pbnN0YW5jZV9kYgogICAgSEFTX0lOU1RBTkNFX0RCID0gVHJ1ZQpleGNlcHQgSW1wb3J0RXJyb3I6CiAgICBIQVNfSU5TVEFOQ0VfREIgPSBGYWxzZQogICAgcHJpbnQoIltXQVJOXSBpbnN0YW5jZV9kYXRhYmFzZSBub3QgYXZhaWxhYmxlIikKCgojIOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkAojIENPTlNUQU5UUwojIOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkAoKU0NIRURVTEVfMTVNID0gKDEsIDE2LCAzMSwgNDYpClNDSEVEVUxFXzFIICA9ICgyLCkKCkRFRkFVTFRfU0lHTkFMX1BBVEggPSBvcy5wYXRoLmpvaW4oCiAgICBvcy5wYXRoLmV4cGFuZHVzZXIoIn4iKSwKICAgICJBcHBEYXRhIiwgIlJvYW1pbmciLCAiTWV0YVF1b3RlcyIsICJUZXJtaW5hbCIsICJDb21tb24iLCAiRmlsZXMiLAogICAgIndlYmhvb2tfc2lnbmFscy50eHQiCikKCkxPR19GT1JNQVQgPSAiJShhc2N0aW1lKXMgWyUobGV2ZWxuYW1lKXNdICUobWVzc2FnZSlzIgoKCiMg4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQCiMgU0NSRUVOU0hPVAojIOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkAoKZGVmIGNhcHR1cmVfc2NyZWVuc2hvdChyZWdpb249Tm9uZSkgLT4gT3B0aW9uYWxbc3RyXToKICAgICIiIkNhcHR1cmUgc2NyZWVuIOKGkiBiYXNlNjQgUE5HLiIiIgogICAgaWYgbm90IEhBU19NU1M6CiAgICAgICAgcmV0dXJuIE5vbmUKICAgIHRyeToKICAgICAgICB3aXRoIG1zcy5tc3MoKSBhcyBzY3Q6CiAgICAgICAgICAgIG1vbml0b3IgPSAoeyJsZWZ0IjogcmVnaW9uWzBdLCAidG9wIjogcmVnaW9uWzFdLAogICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiByZWdpb25bMl0sICJoZWlnaHQiOiByZWdpb25bM119CiAgICAgICAgICAgICAgICAgICAgICAgaWYgcmVnaW9uIGVsc2Ugc2N0Lm1vbml0b3JzWzFdKQogICAgICAgICAgICBzaG90ID0gc2N0LmdyYWIobW9uaXRvcikKICAgICAgICAgICAgcG5nID0gbXNzLnRvb2xzLnRvX3BuZyhzaG90LnJnYiwgc2hvdC5zaXplKQogICAgICAgICAgICByZXR1cm4gYmFzZTY0LnN0YW5kYXJkX2I2NGVuY29kZShwbmcpLmRlY29kZSgidXRmLTgiKQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dpbmcuZXJyb3IoZiJTY3JlZW5zaG90IGZhaWxlZDoge2V9IikKICAgICAgICByZXR1cm4gTm9uZQoKCiMg4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQCiMgQ0xBVURFIEFQSSDigJQgUmV0dXJucyA0IHZpc3VhbCB2ZWN0b3JzIChQQSwgS0wsIE1PTSwgU1RSKQojIOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkAoKZGVmIHNjb3JlX2NoYXJ0KGNsaWVudCwgaW1hZ2VfYjY0OiBzdHIsIHN5bWJvbDogc3RyLCB0aW1lZnJhbWVfbGFiZWw6IHN0ciwKICAgICAgICAgICAgICAgIG1vZGVsOiBzdHIgPSAiY2xhdWRlLXNvbm5ldC00LTIwMjUwNTE0IikgLT4gT3B0aW9uYWxbRGljdF06CiAgICAiIiJTZW5kIHNjcmVlbnNob3QgdG8gQ2xhdWRlIOKGkiA0IHZpc3VhbCB2ZWN0b3Igc2NvcmVzICsgY29tcG9zaXRlX2JpYXMgZ3V0LiIiIgogICAgaW1wb3J0IHJlCiAgICBwcm9tcHQgPSBidWlsZF9zY29yaW5nX3Byb21wdChzeW1ib2wsIHRpbWVmcmFtZV9sYWJlbCkKCiAgICB0cnk6CiAgICAgICAgcmVzcCA9IGNsaWVudC5tZXNzYWdlcy5jcmVhdGUoCiAgICAgICAgICAgIG1vZGVsPW1vZGVsLAogICAgICAgICAgICBtYXhfdG9rZW5zPTIwMDAsCiAgICAgICAgICAgIHRlbXBlcmF0dXJlPTAuMSwKICAgICAgICAgICAgbWVzc2FnZXM9W3sKICAgICAgICAgICAgICAgICJyb2xlIjogInVzZXIiLAogICAgICAgICAgICAgICAgImNvbnRlbnQiOiBbCiAgICAgICAgICAgICAgICAgICAgeyJ0eXBlIjogImltYWdlIiwKICAgICAgICAgICAgICAgICAgICAgInNvdXJjZSI6IHsidHlwZSI6ICJiYXNlNjQiLCAibWVkaWFfdHlwZSI6ICJpbWFnZS9wbmciLCAiZGF0YSI6IGltYWdlX2I2NH19LAogICAgICAgICAgICAgICAgICAgIHsidHlwZSI6ICJ0ZXh0IiwgInRleHQiOiBwcm9tcHR9CiAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgIH1dCiAgICAgICAgKQogICAgICAgIHJhdyA9IHJlc3AuY29udGVudFswXS50ZXh0LnN0cmlwKCkKICAgICAgICBjbGVhbiA9IHJlLnN1YihyJ15gYGBqc29uXHMqJywgJycsIHJhdykKICAgICAgICBjbGVhbiA9IHJlLnN1YihyJ1xzKmBgYCQnLCAnJywgY2xlYW4pCiAgICAgICAgcmV0dXJuIGpzb24ubG9hZHMoY2xlYW4pCgogICAgZXhjZXB0IGpzb24uSlNPTkRlY29kZUVycm9yIGFzIGU6CiAgICAgICAgbG9nZ2luZy5lcnJvcihmIkpTT04gcGFyc2UgZmFpbGVkOiB7ZX0iKQogICAgICAgIHJldHVybiBOb25lCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nZ2luZy5lcnJvcihmIkFQSSBjYWxsIGZhaWxlZDoge2V9IikKICAgICAgICByZXR1cm4gTm9uZQoKCiMg4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQCiMgU0lHTkFMIFdSSVRFUiDigJQgV3JpdGVzIEpTT04gdG8gTVQ1IHdlYmhvb2tfc2lnbmFscy50eHQKIyDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZAKCmRlZiB3cml0ZV9zaWduYWwocGF0aDogc3RyLCBhY3Rpb246IHN0ciwgc3ltYm9sOiBzdHIsCiAgICAgICAgICAgICAgICAgcXR5OiBmbG9hdCA9IDEuMCwgc2w6IGZsb2F0ID0gMCwgdHA6IGZsb2F0ID0gMCwKICAgICAgICAgICAgICAgICBjb21tZW50OiBzdHIgPSAiIikgLT4gYm9vbDoKICAgICIiIgogICAgV3JpdGUgSlNPTiBzaWduYWwgdG8gTVQ1IHdlYmhvb2tfc2lnbmFscy50eHQuCiAgICAKICAgIEFMSUdOTUVOVCB3aXRoIFByb3RlY3Rpb24gJiBEZXRlY3Rpb24gRUEgdjYuNzoKICAgICAgLSBFQSByZWFkcyBmcm9tIEZJTEVfQ09NTU9OIOKGkiBUZXJtaW5hbC9Db21tb24vRmlsZXMvd2ViaG9va19zaWduYWxzLnR4dAogICAgICAtIEVBIHBhcnNlczogYWN0aW9uLCBzeW1ib2wsIHF0eS9sb3RzLCBzbCwgdHAKICAgICAgLSBFQSBtYXJrcyBmaWxlIGFzICJQUk9DRVNTRUQiIGFmdGVyIHJlYWRpbmcKICAgICAgLSBzbC90cCBtdXN0IGJlIEFCU09MVVRFIFBSSUNFIExFVkVMUyAobm90IHBvaW50cykKICAgICIiIgogICAgc2lnID0gewogICAgICAgICJhY3Rpb24iOiBhY3Rpb24udXBwZXIoKSwKICAgICAgICAic3ltYm9sIjogc3ltYm9sLAogICAgICAgICJxdHkiOiByb3VuZChxdHksIDIpLAogICAgICAgICJjb21tZW50IjogY29tbWVudCBvciAiVE9SUkEiCiAgICB9CiAgICBpZiBzbCA+IDA6CiAgICAgICAgc2lnWyJzbCJdID0gcm91bmQoc2wsIDUpCiAgICBpZiB0cCA+IDA6CiAgICAgICAgc2lnWyJ0cCJdID0gcm91bmQodHAsIDUpCgogICAgdHJ5OgogICAgICAgIHNpZ19kaXIgPSBvcy5wYXRoLmRpcm5hbWUocGF0aCkKICAgICAgICBpZiBzaWdfZGlyOgogICAgICAgICAgICBvcy5tYWtlZGlycyhzaWdfZGlyLCBleGlzdF9vaz1UcnVlKQogICAgICAgIHdpdGggb3BlbihwYXRoLCAndycsIGVuY29kaW5nPSdhc2NpaScsIGVycm9ycz0ncmVwbGFjZScsIG5ld2xpbmU9J1xuJykgYXMgZjoKICAgICAgICAgICAgZi53cml0ZShqc29uLmR1bXBzKHNpZykpCiAgICAgICAgbG9nZ2luZy5pbmZvKGYi8J+TnSBTSUdOQUwg4oaSIHtwYXRofToge2pzb24uZHVtcHMoc2lnKX0iKQogICAgICAgIHJldHVybiBUcnVlCiAgICBleGNlcHQgUGVybWlzc2lvbkVycm9yIGFzIGU6CiAgICAgICAgbG9nZ2luZy5lcnJvcihmIlNpZ25hbCB3cml0ZSBQRVJNSVNTSU9OIEVSUk9SOiB7ZX0iKQogICAgICAgIHJldHVybiBGYWxzZQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dpbmcuZXJyb3IoZiJTaWduYWwgd3JpdGUgZmFpbGVkOiB7ZX0iKQogICAgICAgIHJldHVybiBGYWxzZQoKCiMg4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQCiMgTEFZRVIgMiDigJQgQ2xhdWRlIEludGVycHJldGl2ZSBTY29yaW5nIChhZGp1c3RtZW50cyBvbmx5KQojIOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkAoKZGVmIHNjb3JlX2NoYXJ0X2ludGVycHJldGl2ZShjbGllbnQsIGltYWdlX2I2NDogc3RyLCBzeW1ib2w6IHN0ciwgdGltZWZyYW1lX2xhYmVsOiBzdHIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kaWNhdG9yX3NuYXBzaG90OiBkaWN0LCBsYXllcjFfc2NvcmVzOiBkaWN0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsOiBzdHIgPSAiY2xhdWRlLXNvbm5ldC00LTIwMjUwNTE0IikgLT4gT3B0aW9uYWxbRGljdF06CiAgICAiIiIKICAgIExheWVyIDI6IFNlbmQgc2NyZWVuc2hvdCArIGluZGljYXRvciBkYXRhICsgTDEgc2NvcmVzIHRvIENsYXVkZS4KICAgIFJldHVybnMgYWRqdXN0bWVudCBkaWN0IHdpdGggcGVyLWNhdGVnb3J5IGFkanVzdG1lbnRzICgtMC4zIHRvICswLjMpLgogICAgIiIiCiAgICBpbXBvcnQgcmUKICAgIHByb21wdCA9IGJ1aWxkX2ludGVycHJldGl2ZV9wcm9tcHQoc3ltYm9sLCB0aW1lZnJhbWVfbGFiZWwsIGluZGljYXRvcl9zbmFwc2hvdCwgbGF5ZXIxX3Njb3JlcykKCiAgICB0cnk6CiAgICAgICAgcmVzcCA9IGNsaWVudC5tZXNzYWdlcy5jcmVhdGUoCiAgICAgICAgICAgIG1vZGVsPW1vZGVsLAogICAgICAgICAgICBtYXhfdG9rZW5zPTIwMDAsCiAgICAgICAgICAgIHRlbXBlcmF0dXJlPTAuMSwKICAgICAgICAgICAgbWVzc2FnZXM9W3sKICAgICAgICAgICAgICAgICJyb2xlIjogInVzZXIiLAogICAgICAgICAgICAgICAgImNvbnRlbnQiOiBbCiAgICAgICAgICAgICAgICAgICAgeyJ0eXBlIjogImltYWdlIiwKICAgICAgICAgICAgICAgICAgICAgInNvdXJjZSI6IHsidHlwZSI6ICJiYXNlNjQiLCAibWVkaWFfdHlwZSI6ICJpbWFnZS9wbmciLCAiZGF0YSI6IGltYWdlX2I2NH19LAogICAgICAgICAgICAgICAgICAgIHsidHlwZSI6ICJ0ZXh0IiwgInRleHQiOiBwcm9tcHR9CiAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgIH1dCiAgICAgICAgKQogICAgICAgIHJhdyA9IHJlc3AuY29udGVudFswXS50ZXh0LnN0cmlwKCkKICAgICAgICBjbGVhbiA9IHJlLnN1YihyJ15gYGBqc29uXHMqJywgJycsIHJhdykKICAgICAgICBjbGVhbiA9IHJlLnN1YihyJ1xzKmBgYCQnLCAnJywgY2xlYW4pCiAgICAgICAgcGFyc2VkID0ganNvbi5sb2FkcyhjbGVhbikKCiAgICAgICAgIyBDbGFtcCBhbGwgYWRqdXN0bWVudHMgdG8gWy0wLjMsICswLjNdCiAgICAgICAgZm9yIGtleSBpbiBbJ3ByaWNlX2FjdGlvbicsICdrZXlfbGV2ZWxzJywgJ21vbWVudHVtJywgJ3N0cnVjdHVyZSddOgogICAgICAgICAgICBpZiBrZXkgaW4gcGFyc2VkOgogICAgICAgICAgICAgICAgYWRqID0gcGFyc2VkW2tleV0uZ2V0KCdhZGp1c3RtZW50JywgMC4wKQogICAgICAgICAgICAgICAgcGFyc2VkW2tleV1bJ2FkanVzdG1lbnQnXSA9IG1heCgtMC4zLCBtaW4oMC4zLCBmbG9hdChhZGopKSkKCiAgICAgICAgcmV0dXJuIHBhcnNlZAoKICAgIGV4Y2VwdCBqc29uLkpTT05EZWNvZGVFcnJvciBhcyBlOgogICAgICAgIGxvZ2dpbmcuZXJyb3IoZiJMMiBKU09OIHBhcnNlIGZhaWxlZDoge2V9IikKICAgICAgICByZXR1cm4gTm9uZQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dpbmcuZXJyb3IoZiJMMiBBUEkgY2FsbCBmYWlsZWQ6IHtlfSIpCiAgICAgICAgcmV0dXJuIE5vbmUKCgpkZWYgdmFsaWRhdGVfbGF5ZXIyKGxheWVyMjogZGljdCkgLT4gZGljdDoKICAgICIiIgogICAgTGF5ZXIgMzogQ29uc2lzdGVuY3kgdmFsaWRhdGlvbi4KICAgIAogICAgQ2hlY2sgaWYgQ2xhdWRlJ3MgdGV4dCByYXRpb25hbGUgaXMgY29uc2lzdGVudCB3aXRoIGl0cyBudW1lcmljIGFkanVzdG1lbnQuCiAgICBJZiByYXRpb25hbGUgc2F5cyAiYmVhcmlzaCIgYnV0IGFkanVzdG1lbnQgaXMgcG9zaXRpdmUsIHplcm8gaXQgb3V0LgogICAgCiAgICBSZXR1cm5zIHZhbGlkYXRlZCBMMiBkaWN0IHdpdGggYW55IGluY29uc2lzdGVudCBhZGp1c3RtZW50cyB6ZXJvZWQuCiAgICAiIiIKICAgIGlmIG5vdCBsYXllcjI6CiAgICAgICAgcmV0dXJuIE5vbmUKICAgIAogICAgQlVMTElTSF9XT1JEUyA9IHsnYnVsbGlzaCcsICd1cHdhcmQnLCAnYm91bmNlJywgJ2JyZWFrb3V0JywgJ2dyZWVuJywgJ2hpZ2hlcicsICdzdXBwb3J0JywgJ2FjY3VtdWxhdGlvbid9CiAgICBCRUFSSVNIX1dPUkRTID0geydiZWFyaXNoJywgJ2Rvd253YXJkJywgJ3JlamVjdGlvbicsICdicmVha2Rvd24nLCAncmVkJywgJ2xvd2VyJywgJ3Jlc2lzdGFuY2UnLCAnZGlzdHJpYnV0aW9uJ30KICAgIAogICAgdmFsaWRhdGVkID0ganNvbi5sb2Fkcyhqc29uLmR1bXBzKGxheWVyMikpICAjIERlZXAgY29weQogICAgZmxhZ3MgPSBbXQogICAgCiAgICBmb3Iga2V5IGluIFsncHJpY2VfYWN0aW9uJywgJ2tleV9sZXZlbHMnLCAnbW9tZW50dW0nLCAnc3RydWN0dXJlJ106CiAgICAgICAgaWYga2V5IG5vdCBpbiB2YWxpZGF0ZWQ6CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIAogICAgICAgIGVudHJ5ID0gdmFsaWRhdGVkW2tleV0KICAgICAgICBhZGogPSBlbnRyeS5nZXQoJ2FkanVzdG1lbnQnLCAwLjApCiAgICAgICAgcmF0aW9uYWxlID0gZW50cnkuZ2V0KCdyYXRpb25hbGUnLCAnJykubG93ZXIoKQogICAgICAgIGNvbmZpZGVuY2UgPSBlbnRyeS5nZXQoJ2NvbmZpZGVuY2UnLCAnbWVkaXVtJykKICAgICAgICAKICAgICAgICAjIFNraXAgdGlueSBhZGp1c3RtZW50cyDigJQgbm90aGluZyB0byB2YWxpZGF0ZQogICAgICAgIGlmIGFicyhhZGopIDwgMC4wNToKICAgICAgICAgICAgY29udGludWUKICAgICAgICAKICAgICAgICAjIENvdW50IHNlbnRpbWVudCB3b3JkcyBpbiByYXRpb25hbGUKICAgICAgICBidWxsX2NvdW50ID0gc3VtKDEgZm9yIHcgaW4gQlVMTElTSF9XT1JEUyBpZiB3IGluIHJhdGlvbmFsZSkKICAgICAgICBiZWFyX2NvdW50ID0gc3VtKDEgZm9yIHcgaW4gQkVBUklTSF9XT1JEUyBpZiB3IGluIHJhdGlvbmFsZSkKICAgICAgICAKICAgICAgICAjIENoZWNrIGNvbnNpc3RlbmN5CiAgICAgICAgaW5jb25zaXN0ZW50ID0gRmFsc2UKICAgICAgICBpZiBhZGogPiAwLjA1IGFuZCBiZWFyX2NvdW50ID4gYnVsbF9jb3VudDoKICAgICAgICAgICAgaW5jb25zaXN0ZW50ID0gVHJ1ZQogICAgICAgIGVsaWYgYWRqIDwgLTAuMDUgYW5kIGJ1bGxfY291bnQgPiBiZWFyX2NvdW50OgogICAgICAgICAgICBpbmNvbnNpc3RlbnQgPSBUcnVlCiAgICAgICAgCiAgICAgICAgaWYgaW5jb25zaXN0ZW50OgogICAgICAgICAgICBmbGFncy5hcHBlbmQoZiJ7a2V5fTogYWRqPXthZGo6Ky4yZn0gYnV0IHJhdGlvbmFsZSBsZWFucyAiCiAgICAgICAgICAgICAgICAgICAgICAgIGYieydiZWFyaXNoJyBpZiBhZGogPiAwIGVsc2UgJ2J1bGxpc2gnfSDigJQgemVyb2VkIikKICAgICAgICAgICAgZW50cnlbJ2FkanVzdG1lbnQnXSA9IDAuMAogICAgICAgICAgICBlbnRyeVsnY29uZmlkZW5jZSddID0gJ3JlamVjdGVkJwogICAgICAgIAogICAgICAgICMgUmVkdWNlIGxvdy1jb25maWRlbmNlIGFkanVzdG1lbnRzCiAgICAgICAgaWYgY29uZmlkZW5jZSA9PSAnbG93JzoKICAgICAgICAgICAgZW50cnlbJ2FkanVzdG1lbnQnXSA9IGVudHJ5WydhZGp1c3RtZW50J10gKiAwLjUKICAgIAogICAgaWYgZmxhZ3M6CiAgICAgICAgdmFsaWRhdGVkWydfdmFsaWRhdGlvbl9mbGFncyddID0gZmxhZ3MKICAgICAgICBsb2dnaW5nLmluZm8oZiIgIEwzIFZhbGlkYXRpb246IHtsZW4oZmxhZ3MpfSBpbmNvbnNpc3RlbmNpZXMgY2F1Z2h0IikKICAgIAogICAgcmV0dXJuIHZhbGlkYXRlZAoKCiMg4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQCiMgSEVMUEVSUwojIOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkAoKZGVmIF9leHRyYWN0KHNjb3JlczogRGljdCwga2V5OiBzdHIpIC0+IGZsb2F0OgogICAgIiIiU2FmZWx5IGV4dHJhY3QgbnVtZXJpYyBzY29yZSBmcm9tIEFQSSByZXNwb25zZS4iIiIKICAgIHZhbCA9IHNjb3Jlcy5nZXQoa2V5LCAwKQogICAgaWYgaXNpbnN0YW5jZSh2YWwsIGRpY3QpOgogICAgICAgIHJldHVybiBmbG9hdCh2YWwuZ2V0KCJzY29yZSIsIDApKQogICAgcmV0dXJuIGZsb2F0KHZhbCkKCgpkZWYgX2V4dHJhY3Rfbm90ZShzY29yZXM6IERpY3QsIGtleTogc3RyKSAtPiBzdHI6CiAgICAiIiJTYWZlbHkgZXh0cmFjdCBub3RlIHRleHQgZnJvbSBBUEkgcmVzcG9uc2UuIiIiCiAgICB2YWwgPSBzY29yZXMuZ2V0KGtleSwgIiIpCiAgICBpZiBpc2luc3RhbmNlKHZhbCwgZGljdCk6CiAgICAgICAgcmV0dXJuIHZhbC5nZXQoIm5vdGUiLCAiIikKICAgIHJldHVybiAiIgoKCiMg4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQCiMgQ09ORklHLUZJUlNUIFZBTElEQVRJT04KIyDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZAKCmRlZiB2YWxpZGF0ZV9jb25maWcoZGIsIGluc3RhbmNlKSAtPiBkaWN0OgogICAgIiIiCiAgICBWYWxpZGF0ZSB0aGF0IGV2ZXJ5dGhpbmcgbmVlZGVkIHRvIHRyYWRlIGlzIHByZXNlbnQuCiAgICBSZXR1cm5zIHsndmFsaWQnOiBUcnVlL0ZhbHNlLCAnZXJyb3JzJzogWy4uLl0sICdwcm9maWxlJzogUHJvZmlsZXxOb25lLCAndHJhZGluZ19jb25maWcnOiBkaWN0fE5vbmV9CiAgICAiIiIKICAgIGVycm9ycyA9IFtdCgogICAgIyBJbnN0YW5jZSBtdXN0IGV4aXN0CiAgICBpZiBub3QgaW5zdGFuY2U6CiAgICAgICAgcmV0dXJuIHsndmFsaWQnOiBGYWxzZSwgJ2Vycm9ycyc6IFsnSW5zdGFuY2Ugbm90IGZvdW5kJ10sICdwcm9maWxlJzogTm9uZSwgJ3RyYWRpbmdfY29uZmlnJzogTm9uZX0KCiAgICAjIFByb2ZpbGUgbXVzdCBiZSBsaW5rZWQKICAgIGlmIG5vdCBpbnN0YW5jZS5wcm9maWxlX2lkOgogICAgICAgIGVycm9ycy5hcHBlbmQoJ05vIHByb2ZpbGUgbGlua2VkIHRvIGluc3RhbmNlIOKAlCBjb25maWd1cmUgaW4gUHJvZmlsZSBNYW5hZ2VyJykKICAgICAgICByZXR1cm4geyd2YWxpZCc6IEZhbHNlLCAnZXJyb3JzJzogZXJyb3JzLCAncHJvZmlsZSc6IE5vbmUsICd0cmFkaW5nX2NvbmZpZyc6IE5vbmV9CgogICAgIyBQcm9maWxlIG11c3QgZXhpc3QKICAgIHByb2ZpbGUgPSBkYi5nZXRfcHJvZmlsZShpbnN0YW5jZS5wcm9maWxlX2lkKQogICAgaWYgbm90IHByb2ZpbGU6CiAgICAgICAgZXJyb3JzLmFwcGVuZChmJ1Byb2ZpbGUge2luc3RhbmNlLnByb2ZpbGVfaWR9IG5vdCBmb3VuZCBpbiBkYXRhYmFzZScpCiAgICAgICAgcmV0dXJuIHsndmFsaWQnOiBGYWxzZSwgJ2Vycm9ycyc6IGVycm9ycywgJ3Byb2ZpbGUnOiBOb25lLCAndHJhZGluZ19jb25maWcnOiBOb25lfQoKICAgICMgUGFyc2UgdHJhZGluZ19jb25maWcKICAgIHRjID0gTm9uZQogICAgaWYgcHJvZmlsZS50cmFkaW5nX2NvbmZpZzoKICAgICAgICB0cnk6CiAgICAgICAgICAgIHRjID0ganNvbi5sb2Fkcyhwcm9maWxlLnRyYWRpbmdfY29uZmlnKSBpZiBpc2luc3RhbmNlKHByb2ZpbGUudHJhZGluZ19jb25maWcsIHN0cikgZWxzZSBwcm9maWxlLnRyYWRpbmdfY29uZmlnCiAgICAgICAgZXhjZXB0IChqc29uLkpTT05EZWNvZGVFcnJvciwgVHlwZUVycm9yKToKICAgICAgICAgICAgdGMgPSBOb25lCgogICAgaWYgbm90IHRjOgogICAgICAgIGVycm9ycy5hcHBlbmQoJ1Byb2ZpbGUgaGFzIG5vIHZhbGlkIHRyYWRpbmdfY29uZmlnJykKICAgICAgICByZXR1cm4geyd2YWxpZCc6IEZhbHNlLCAnZXJyb3JzJzogZXJyb3JzLCAncHJvZmlsZSc6IHByb2ZpbGUsICd0cmFkaW5nX2NvbmZpZyc6IE5vbmV9CgogICAgIyBXZWlnaHRzIG11c3QgZXhpc3QgYW5kIGJlIHJlYXNvbmFibGUKICAgIHN3ID0gdGMuZ2V0KCdzZW50aW1lbnRfd2VpZ2h0cycsIHt9KQogICAgaWYgbm90IHN3OgogICAgICAgIGVycm9ycy5hcHBlbmQoJ3RyYWRpbmdfY29uZmlnIG1pc3Npbmcgc2VudGltZW50X3dlaWdodHMnKQogICAgZWxzZToKICAgICAgICB3X3N1bSA9IHN1bShmbG9hdCh2KSBmb3IgdiBpbiBzdy52YWx1ZXMoKSkKICAgICAgICBpZiBhYnMod19zdW0gLSAxLjApID4gMC4wNToKICAgICAgICAgICAgZXJyb3JzLmFwcGVuZChmJ3NlbnRpbWVudF93ZWlnaHRzIHN1bSB0byB7d19zdW06LjNmfSwgZXhwZWN0ZWQgfjEuMCcpCgogICAgIyBUaHJlc2hvbGRzIG11c3QgZXhpc3QKICAgIGlmIG5vdCB0Yy5nZXQoJ3RocmVzaG9sZHMnKToKICAgICAgICBlcnJvcnMuYXBwZW5kKCd0cmFkaW5nX2NvbmZpZyBtaXNzaW5nIHRocmVzaG9sZHMnKQoKICAgICMgQVBJIGNsaWVudCBtdXN0IGJlIGNyZWF0YWJsZQogICAgYXBpX2tleSA9IChvcy5nZXRlbnYoIlRPUlJBX0FQSV9LRVkiKQogICAgICAgICAgICAgICBvciBvcy5nZXRlbnYoIkFOVEhST1BJQ19BUElfS0VZIikKICAgICAgICAgICAgICAgb3Igb3MuZ2V0ZW52KCJHT09HTEVfQVBJX0tFWSIpCiAgICAgICAgICAgICAgIG9yIG9zLmdldGVudigiT1BFTkFJX0FQSV9LRVkiKSkKICAgIGlmIG5vdCBhcGlfa2V5OgogICAgICAgIGVycm9ycy5hcHBlbmQoJ05vIEFQSSBrZXkg4oCUIGNvbmZpZ3VyZSBpbiBQcm9maWxlIE1hbmFnZXIgYW5kIGFjdGl2YXRlIGZyb20gZnJvbnRlbmQnKQoKICAgIHJldHVybiB7CiAgICAgICAgJ3ZhbGlkJzogbGVuKGVycm9ycykgPT0gMCwKICAgICAgICAnZXJyb3JzJzogZXJyb3JzLAogICAgICAgICdwcm9maWxlJzogcHJvZmlsZSwKICAgICAgICAndHJhZGluZ19jb25maWcnOiB0YwogICAgfQoKCiMg4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQCiMgVE9SUkEgVFJBREVSIOKAlCBUaGluIEV4ZWN1dG9yCiMg4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQCgpjbGFzcyBUb3JyYVRyYWRlcjoKICAgICIiIgogICAgQ29uZmlnLWZpcnN0IHRoaW4gZXhlY3V0b3IuCiAgICAKICAgIFBlciB0aWNrOiBzY3JlZW5zaG90IOKGkiBDbGF1ZGUgQVBJICg0IHZlY3RvcnMpIOKGkiBBVEggaW5qZWN0aW9uIOKGkiBEQiB3cml0ZSDihpIgcmVhZCB2ZXJkaWN0IOKGkiBleGVjdXRlLgogICAgVGhlIGRhdGFiYXNlIChzYXZlX3NlbnRpbWVudCkgaXMgdGhlIHNjb3JpbmcgYnJhaW4uIFRoaXMgY2xhc3MganVzdCBwaXBlcyBkYXRhIHRocm91Z2guCiAgICAiIiIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaW5zdGFuY2VfaWQ6IHN0ciwgZGJfcGF0aDogc3RyID0gTm9uZSwKICAgICAgICAgICAgICAgICBzaWduYWxfcGF0aDogc3RyID0gREVGQVVMVF9TSUdOQUxfUEFUSCk6CiAgICAgICAgc2VsZi5pbnN0YW5jZV9pZCA9IGluc3RhbmNlX2lkCiAgICAgICAgc2VsZi5zaWduYWxfcGF0aCA9IHNpZ25hbF9wYXRoCiAgICAgICAgc2VsZi5fc2h1dGRvd24gPSBGYWxzZQoKICAgICAgICAjIOKUgOKUgCBEYXRhYmFzZSDilIDilIAKICAgICAgICBkYl9wYXRoID0gZGJfcGF0aCBvciBvcy5wYXRoLmpvaW4oQkFTRV9ESVIsICJhcGV4X2luc3RhbmNlcy5kYiIpCiAgICAgICAgc2VsZi5kYiA9IGdldF9pbnN0YW5jZV9kYihkYl9wYXRoKQoKICAgICAgICAjIOKUgOKUgCBMb2FkICYgdmFsaWRhdGUgaW5zdGFuY2UgKyBwcm9maWxlIOKUgOKUgAogICAgICAgIHNlbGYuaW5zdGFuY2UgPSBzZWxmLmRiLmdldF9pbnN0YW5jZShpbnN0YW5jZV9pZCkKICAgICAgICBjb25maWdfY2hlY2sgPSB2YWxpZGF0ZV9jb25maWcoc2VsZi5kYiwgc2VsZi5pbnN0YW5jZSkKCiAgICAgICAgaWYgbm90IGNvbmZpZ19jaGVja1sndmFsaWQnXToKICAgICAgICAgICAgZm9yIGVyciBpbiBjb25maWdfY2hlY2tbJ2Vycm9ycyddOgogICAgICAgICAgICAgICAgcHJpbnQoZiIgIOKclyB7ZXJyfSIpCiAgICAgICAgICAgIHByaW50KCJcbiAgVHJhZGVyIGNhbm5vdCBzdGFydCB3aXRob3V0IHZhbGlkIGNvbmZpZy4gRXhpdGluZy4iKQogICAgICAgICAgICBzeXMuZXhpdCgxKQoKICAgICAgICBzZWxmLnByb2ZpbGUgPSBjb25maWdfY2hlY2tbJ3Byb2ZpbGUnXQogICAgICAgIHNlbGYudGMgPSBjb25maWdfY2hlY2tbJ3RyYWRpbmdfY29uZmlnJ10KICAgICAgICBzZWxmLnN5bWJvbCA9IHNlbGYuaW5zdGFuY2Uuc3ltYm9sCgogICAgICAgICMg4pSA4pSAIEFQSSBjbGllbnQg4pSA4pSACiAgICAgICAgYXBpX2tleSA9IChvcy5nZXRlbnYoIlRPUlJBX0FQSV9LRVkiKQogICAgICAgICAgICAgICAgICAgb3Igb3MuZ2V0ZW52KCJBTlRIUk9QSUNfQVBJX0tFWSIpCiAgICAgICAgICAgICAgICAgICBvciBvcy5nZXRlbnYoIkdPT0dMRV9BUElfS0VZIikKICAgICAgICAgICAgICAgICAgIG9yIG9zLmdldGVudigiT1BFTkFJX0FQSV9LRVkiKSkKICAgICAgICBzZWxmLnByb3ZpZGVyID0gb3MuZ2V0ZW52KCJUT1JSQV9QUk9WSURFUiIsICJhbnRocm9waWMiKQogICAgICAgIHNlbGYubW9kZWwgPSBvcy5nZXRlbnYoIlRPUlJBX01PREVMIikgb3Igc2VsZi5wcm9maWxlLnNlbnRpbWVudF9tb2RlbCBvciAiY2xhdWRlLXNvbm5ldC00LTIwMjUwNTE0IgogICAgICAgIHNlbGYuY2xpZW50ID0gYW50aHJvcGljLkFudGhyb3BpYyhhcGlfa2V5PWFwaV9rZXkpIGlmIGFwaV9rZXkgYW5kIEhBU19BTlRIUk9QSUMgZWxzZSBOb25lCgogICAgICAgICMg4pSA4pSAIFJhdGUgbGltaXRpbmcg4pSA4pSACiAgICAgICAgc2VsZi5fbGFzdF8xNW1fbWludXRlID0gLTEKICAgICAgICBzZWxmLl9sYXN0XzFoX21pbnV0ZSA9IC0xCiAgICAgICAgc2VsZi5fbGFzdF9zaWduYWxfdGltZSA9IE5vbmUKICAgICAgICBzZWxmLl9zaWduYWxzX3RoaXNfaG91ciA9IDAKICAgICAgICBzZWxmLl9ob3VyX3N0YXJ0ID0gZGF0ZXRpbWUubm93KCkucmVwbGFjZShtaW51dGU9MCwgc2Vjb25kPTAsIG1pY3Jvc2Vjb25kPTApCiAgICAgICAgc2VsZi5faXRlcmF0aW9uID0gMAoKICAgICAgICAjIOKUgOKUgCBFeHRyYWN0IGRpc3BsYXkgdmFsdWVzIGZyb20gdHJhZGluZ19jb25maWcg4pSA4pSACiAgICAgICAgc3cgPSBzZWxmLnRjLmdldCgnc2VudGltZW50X3dlaWdodHMnLCB7fSkKICAgICAgICB0dyA9IHNlbGYudGMuZ2V0KCd0aW1lZnJhbWVfd2VpZ2h0cycsIHt9KQogICAgICAgIHRoID0gc2VsZi50Yy5nZXQoJ3RocmVzaG9sZHMnLCB7fSkKICAgICAgICByaXNrID0gc2VsZi50Yy5nZXQoJ3Jpc2snLCB7fSkKCiAgICAgICAgIyDilIDilIAgU3RhcnR1cCBiYW5uZXIg4pSA4pSACiAgICAgICAgcHJpbnQoIlxuIiArICLilZAiICogNjApCiAgICAgICAgcHJpbnQoIiAg8J+UtyBUT1JSQSBUUkFERVIgdjIuMCDigJQgQ09ORklHLUZJUlNUIEVYRUNVVE9SIikKICAgICAgICBwcmludChmIiAgSW5zdGFuY2U6ICB7c2VsZi5pbnN0YW5jZV9pZH0iKQogICAgICAgIHByaW50KGYiICBTeW1ib2w6ICAgIHtzZWxmLnN5bWJvbH0iKQogICAgICAgIHByaW50KGYiICBQcm9maWxlOiAgIHtzZWxmLnByb2ZpbGUubmFtZX0gKHtzZWxmLnByb2ZpbGUuaWR9KSIpCiAgICAgICAgcHJpbnQoZiIgIE1vZGVsOiAgICAge3NlbGYubW9kZWx9IikKICAgICAgICBwcmludChmIiAgVGhyZXNob2xkOiDCsXt0aC5nZXQoJ2J1eScsIDAuNTUpfSIpCiAgICAgICAgcHJpbnQoZiIgIFdlaWdodHM6ICAgUEE6e3N3LmdldCgncHJpY2VfYWN0aW9uJywwKTouMmZ9IEtMOntzdy5nZXQoJ2tleV9sZXZlbHMnLDApOi4yZn0gIgogICAgICAgICAgICAgIGYiTU9NOntzdy5nZXQoJ21vbWVudHVtJywwKTouMmZ9IEFUSDp7c3cuZ2V0KCdhdGgnLDAuMTApOi4yZn0gU1RSOntzdy5nZXQoJ3N0cnVjdHVyZScsMCk6LjJmfSIpCiAgICAgICAgcHJpbnQoZiIgIFRGIEJsZW5kOiAgMTVtOnt0dy5nZXQoJzE1bScsMC40MCk6LjJmfSB8IDFoOnt0dy5nZXQoJzFoJywwLjYwKTouMmZ9IikKICAgICAgICBwcmludChmIiAgTG90IFNpemU6ICB7cmlzay5nZXQoJ2Jhc2VfbG90cycsIDEuMCl9IikKICAgICAgICBwcmludChmIiAgU2lnbmFsOiAgICB7c2VsZi5zaWduYWxfcGF0aH0iKQogICAgICAgIHByaW50KCLilZAiICogNjApCgogICAgIyDilIDilIDilIAgU2NoZWR1bGUg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSACgogICAgZGVmIF9pc18xNW1fdGljayhzZWxmKSAtPiBib29sOgogICAgICAgIG0gPSBkYXRldGltZS5ub3coKS5taW51dGUKICAgICAgICBpZiBtIGluIFNDSEVEVUxFXzE1TSBhbmQgbSAhPSBzZWxmLl9sYXN0XzE1bV9taW51dGU6CiAgICAgICAgICAgIHNlbGYuX2xhc3RfMTVtX21pbnV0ZSA9IG0KICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBkZWYgX2lzXzFoX3RpY2soc2VsZikgLT4gYm9vbDoKICAgICAgICBtID0gZGF0ZXRpbWUubm93KCkubWludXRlCiAgICAgICAgaWYgbSBpbiBTQ0hFRFVMRV8xSCBhbmQgbSAhPSBzZWxmLl9sYXN0XzFoX21pbnV0ZToKICAgICAgICAgICAgc2VsZi5fbGFzdF8xaF9taW51dGUgPSBtCiAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgZGVmIF9yZXNldF9ob3VybHkoc2VsZik6CiAgICAgICAgbm93ID0gZGF0ZXRpbWUubm93KCkKICAgICAgICBob3VyID0gbm93LnJlcGxhY2UobWludXRlPTAsIHNlY29uZD0wLCBtaWNyb3NlY29uZD0wKQogICAgICAgIGlmIGhvdXIgPiBzZWxmLl9ob3VyX3N0YXJ0OgogICAgICAgICAgICBzZWxmLl9ob3VyX3N0YXJ0ID0gaG91cgogICAgICAgICAgICBzZWxmLl9zaWduYWxzX3RoaXNfaG91ciA9IDAKCiAgICAjIOKUgOKUgOKUgCBDb3JlIFBpcGVsaW5lIChwZXIgdGljaykg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSACgogICAgZGVmIF90aWNrKHNlbGYsIHRpbWVmcmFtZTogc3RyKToKICAgICAgICAiIiIKICAgICAgICBUaHJlZS1MYXllciBTY29yaW5nIFBpcGVsaW5lIChTZWVkIDIxKToKICAgICAgICAgIDEuIExheWVyIDE6IERldGVybWluaXN0aWMgdGVjaG5pY2FsIHNjb3JlcyBmcm9tIGludGVsbGlnZW5jZSBEQgogICAgICAgICAgMi4gU2NyZWVuc2hvdAogICAgICAgICAgMy4gTGF5ZXIgMjogQ2xhdWRlIGludGVycHJldHMgaW5kaWNhdG9ycyArIHNjcmVlbnNob3Qg4oaSIGFkanVzdG1lbnRzCiAgICAgICAgICA0LiBMYXllciAzOiBWYWxpZGF0ZSBMMiBjb25zaXN0ZW5jeSAodGV4dCB2cyBudW1lcmljKQogICAgICAgICAgNS4gQmxlbmQ6IGZpbmFsID0gMC44MCAqIEwxICsgMC4yMCAqIEwyX2FkanVzdG1lbnQKICAgICAgICAgIDYuIEFUSCBzY29yZSAoZGV0ZXJtaW5pc3RpYykKICAgICAgICAgIDcuIHNhdmVfc2VudGltZW50KCkg4oaSIERCIGFwcGxpZXMgd2VpZ2h0cywgYmxlbmRzLCBkZWNpZGVzCiAgICAgICAgICA4LiBSZWFkIHZlcmRpY3QgZnJvbSBEQgogICAgICAgICAgOS4gRXhlY3V0ZSBpZiBtZWV0c190aHJlc2hvbGQKICAgICAgICAiIiIKICAgICAgICBzZWxmLl9pdGVyYXRpb24gKz0gMQogICAgICAgIHRmX2xhYmVsID0gIjE1LW1pbnV0ZSIgaWYgdGltZWZyYW1lID09ICIxNW0iIGVsc2UgIjEtaG91ciIKICAgICAgICBub3dfaXNvID0gZGF0ZXRpbWUudXRjbm93KCkuaXNvZm9ybWF0KCkgKyAiWiIKCiAgICAgICAgIyBIb3QtcmVsb2FkIGNvbmZpZyBzbyBVSSBjaGFuZ2VzIHRha2UgZWZmZWN0IGltbWVkaWF0ZWx5CiAgICAgICAgc2VsZi5fcmVsb2FkX2NvbmZpZygpCiAgICAgICAgX3RoID0gc2VsZi50Yy5nZXQoJ3RocmVzaG9sZHMnLCB7fSkKICAgICAgICBfcmlzayA9IHNlbGYudGMuZ2V0KCdyaXNrJywge30pCgogICAgICAgIHByaW50KGYiXG7ilIDilIDilIDilIAge3RpbWVmcmFtZS51cHBlcigpfSBUSUNLIEAge2RhdGV0aW1lLm5vdygpLnN0cmZ0aW1lKCclSDolTScpfSAiCiAgICAgICAgICAgICAgZiJ7J+KUgCcgKiA0MH0iKQogICAgICAgIHByaW50KGYiICBDb25maWc6IEJVWT49e190aC5nZXQoJ2J1eScsIDAuNTUpOisuM2Z9ICBTRUxMPD17X3RoLmdldCgnc2VsbCcsIC0wLjU1KTorLjNmfSAgIgogICAgICAgICAgICAgIGYibG90cz17X3Jpc2suZ2V0KCdiYXNlX2xvdHMnLCAxLjApfSAgY2Q9e19yaXNrLmdldCgnY29vbGRvd25fc2Vjb25kcycsIDMwMCl9cyIpCgogICAgICAgICMg4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQCiAgICAgICAgIyBMQVlFUiAxOiBEZXRlcm1pbmlzdGljIFRlY2huaWNhbCBTY29yZXMgKGZyb20gaW50ZWxsaWdlbmNlIERCKQogICAgICAgICMg4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQCiAgICAgICAgbDFfc3RhcnQgPSB0aW1lLnRpbWUoKQogICAgICAgIGwxID0gY2FsY3VsYXRlX3RlY2huaWNhbF9zY29yZXMoc2VsZi5zeW1ib2wpCiAgICAgICAgbDFfbXMgPSBpbnQoKHRpbWUudGltZSgpIC0gbDFfc3RhcnQpICogMTAwMCkKCiAgICAgICAgaWYgbDE6CiAgICAgICAgICAgIHByaW50KGYiICBcVTAwMDFmNGNhIEwxIFRlY2huaWNhbCAoe2wxX21zfW1zLCB7bDEuZ2V0KCdmcmVzaG5lc3Nfc2Vjb25kcycsIDApOi4wZn1zIGFnbyk6IikKICAgICAgICAgICAgcHJpbnQoZiIgICAgIFBBOntsMVsncHJpY2VfYWN0aW9uJ11bJ3Njb3JlJ106Ky4zZn0gICIKICAgICAgICAgICAgICAgICAgZiJLTDp7bDFbJ2tleV9sZXZlbHMnXVsnc2NvcmUnXTorLjNmfSAgIgogICAgICAgICAgICAgICAgICBmIk1PTTp7bDFbJ21vbWVudHVtJ11bJ3Njb3JlJ106Ky4zZn0gICIKICAgICAgICAgICAgICAgICAgZiJTVFI6e2wxWydzdHJ1Y3R1cmUnXVsnc2NvcmUnXTorLjNmfSIKICAgICAgICAgICAgICAgICAgZiJ7JyAg4pqg77iPIFNUQUxFJyBpZiBsMS5nZXQoJ3N0YWxlJykgZWxzZSAnJ30iKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KGYiICDimqDvuI8gIEwxIFRlY2huaWNhbCBGQUlMRUQg4oCUIGZhbGxpbmcgYmFjayB0byBwdXJlIENsYXVkZSBzY29yaW5nIikKCiAgICAgICAgIyDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZAKICAgICAgICAjIFNDUkVFTlNIT1QKICAgICAgICAjIOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkAogICAgICAgIGltYWdlX2I2NCA9IGNhcHR1cmVfc2NyZWVuc2hvdCgpCiAgICAgICAgaWYgbm90IGltYWdlX2I2NDoKICAgICAgICAgICAgaWYgbDE6CiAgICAgICAgICAgICAgICAjIEwxIGF2YWlsYWJsZSBidXQgbm8gc2NyZWVuc2hvdCDihpIgdXNlIEwxIG9ubHkgKG5vIEwyKQogICAgICAgICAgICAgICAgcHJpbnQoZiIgIFxVMDAwMWY0ZjggU2NyZWVuc2hvdCBmYWlsZWQg4oCUIHVzaW5nIEwxIHNjb3JlcyBvbmx5IChubyBMMikiKQogICAgICAgICAgICAgICAgcGEsIGtsLCBtb20sIHN0cnUgPSAobDFbJ3ByaWNlX2FjdGlvbiddWydzY29yZSddLCBsMVsna2V5X2xldmVscyddWydzY29yZSddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbDFbJ21vbWVudHVtJ11bJ3Njb3JlJ10sIGwxWydzdHJ1Y3R1cmUnXVsnc2NvcmUnXSkKICAgICAgICAgICAgICAgIGVsYXBzZWRfbXMgPSBsMV9tcwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgbG9nZ2luZy5lcnJvcigiICBcVTAwMDFmNGY4IFNjcmVlbnNob3QgZmFpbGVkIGFuZCBubyBMMSDihpIgc2tpcHBpbmcgdGljayIpCiAgICAgICAgICAgICAgICBzZWxmLl9zYXZlX2Vycm9yX3Jvdyh0aW1lZnJhbWUsIG5vd19pc28sIDAsICJOT19EQVRBIikKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KGYiICBcVTAwMDFmNGY4IFNjcmVlbnNob3QgY2FwdHVyZWQgKHtsZW4oaW1hZ2VfYjY0KSAvLyAxMDI0fUtCKSIpCgogICAgICAgICMg4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQCiAgICAgICAgIyBMQVlFUiAyOiBDbGF1ZGUgSW50ZXJwcmV0aXZlIFNjb3JpbmcgKGFkanVzdG1lbnRzKQogICAgICAgICMg4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQCiAgICAgICAgbDIgPSBOb25lCiAgICAgICAgbDJfZWxhcHNlZF9tcyA9IDAKICAgICAgICAKICAgICAgICBpZiBpbWFnZV9iNjQgYW5kIHNlbGYuY2xpZW50OgogICAgICAgICAgICBpZiBsMToKICAgICAgICAgICAgICAgICMgRnVsbCB0aHJlZS1sYXllciBtb2RlOiBDbGF1ZGUgaW50ZXJwcmV0cyBMMSArIGNoYXJ0CiAgICAgICAgICAgICAgICBsMl9zdGFydCA9IHRpbWUudGltZSgpCiAgICAgICAgICAgICAgICBsMiA9IHNjb3JlX2NoYXJ0X2ludGVycHJldGl2ZSgKICAgICAgICAgICAgICAgICAgICBzZWxmLmNsaWVudCwgaW1hZ2VfYjY0LCBzZWxmLnN5bWJvbCwgdGZfbGFiZWwsCiAgICAgICAgICAgICAgICAgICAgbDEuZ2V0KCdpbmRpY2F0b3Jfc25hcHNob3QnLCB7fSksIGwxLAogICAgICAgICAgICAgICAgICAgIG1vZGVsPXNlbGYubW9kZWwKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIGwyX2VsYXBzZWRfbXMgPSBpbnQoKHRpbWUudGltZSgpIC0gbDJfc3RhcnQpICogMTAwMCkKCiAgICAgICAgICAgICAgICBpZiBsMjoKICAgICAgICAgICAgICAgICAgICAjIOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkAogICAgICAgICAgICAgICAgICAgICMgTEFZRVIgMzogVmFsaWRhdGUgTDIgQ29uc2lzdGVuY3kKICAgICAgICAgICAgICAgICAgICAjIOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkAogICAgICAgICAgICAgICAgICAgIGwyID0gdmFsaWRhdGVfbGF5ZXIyKGwyKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHBhX2FkaiA9IGwyLmdldCgncHJpY2VfYWN0aW9uJywge30pLmdldCgnYWRqdXN0bWVudCcsIDApCiAgICAgICAgICAgICAgICAgICAga2xfYWRqID0gbDIuZ2V0KCdrZXlfbGV2ZWxzJywge30pLmdldCgnYWRqdXN0bWVudCcsIDApCiAgICAgICAgICAgICAgICAgICAgbW9tX2FkaiA9IGwyLmdldCgnbW9tZW50dW0nLCB7fSkuZ2V0KCdhZGp1c3RtZW50JywgMCkKICAgICAgICAgICAgICAgICAgICBzdHJfYWRqID0gbDIuZ2V0KCdzdHJ1Y3R1cmUnLCB7fSkuZ2V0KCdhZGp1c3RtZW50JywgMCkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBwcmludChmIiAgXFUwMDAxZjkxNiBMMiBJbnRlcnByZXRpdmUgKHtsMl9lbGFwc2VkX21zfW1zKToiKQogICAgICAgICAgICAgICAgICAgIHByaW50KGYiICAgICBhZGogUEE6e3BhX2FkajorLjJmfSAgS0w6e2tsX2FkajorLjJmfSAgIgogICAgICAgICAgICAgICAgICAgICAgICAgIGYiTU9NOnttb21fYWRqOisuMmZ9ICBTVFI6e3N0cl9hZGo6Ky4yZn0iKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICMgU2hvdyB2YWxpZGF0aW9uIGZsYWdzIGlmIGFueQogICAgICAgICAgICAgICAgICAgIGZsYWdzID0gbDIuZ2V0KCdfdmFsaWRhdGlvbl9mbGFncycsIFtdKQogICAgICAgICAgICAgICAgICAgIGlmIGZsYWdzOgogICAgICAgICAgICAgICAgICAgICAgICBwcmludChmIiAgXFUwMDAxZjZhOCBMMyBWYWxpZGF0aW9uOiB7bGVuKGZsYWdzKX0gYWRqdXN0bWVudChzKSByZWplY3RlZCIpCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBmX21zZyBpbiBmbGFnczoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGYiICAgICB7Zl9tc2d9IikKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBiaWFzID0gbDIuZ2V0KCdvdmVyYWxsX2Fzc2Vzc21lbnQnLCB7fSkuZ2V0KCdiaWFzJywgJ25ldXRyYWwnKQogICAgICAgICAgICAgICAgICAgIG1hcmtldF9vcGVuID0gbDIuZ2V0KCdvdmVyYWxsX2Fzc2Vzc21lbnQnLCB7fSkuZ2V0KCdtYXJrZXRfb3BlbicsIFRydWUpCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiIgICAgIE92ZXJhbGw6IHtiaWFzfSIKICAgICAgICAgICAgICAgICAgICAgICAgICBmInsnJyBpZiBtYXJrZXRfb3BlbiBlbHNlICcgKE1BUktFVCBDTE9TRUQpJ30iKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBwcmludChmIiAg4pqg77iPICBMMiBBUEkgZmFpbGVkIOKAlCB1c2luZyBMMSBvbmx5IikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICMgTm8gTDEgZGF0YSDihpIgZmFsbCBiYWNrIHRvIGxlZ2FjeSBwdXJlLXZpc2lvbiBzY29yaW5nCiAgICAgICAgICAgICAgICBwcmludChmIiAgXFUwMDAxZjkxNiBGYWxsYmFjazogcHVyZSBDbGF1ZGUgc2NvcmluZyAobm8gTDEgZGF0YSkiKQogICAgICAgICAgICAgICAgbDJfc3RhcnQgPSB0aW1lLnRpbWUoKQogICAgICAgICAgICAgICAgbGVnYWN5X3Njb3JlcyA9IHNjb3JlX2NoYXJ0KHNlbGYuY2xpZW50LCBpbWFnZV9iNjQsIHNlbGYuc3ltYm9sLCB0Zl9sYWJlbCwgc2VsZi5tb2RlbCkKICAgICAgICAgICAgICAgIGwyX2VsYXBzZWRfbXMgPSBpbnQoKHRpbWUudGltZSgpIC0gbDJfc3RhcnQpICogMTAwMCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgbGVnYWN5X3Njb3JlczoKICAgICAgICAgICAgICAgICAgICBwYSA9IF9leHRyYWN0KGxlZ2FjeV9zY29yZXMsICJwcmljZV9hY3Rpb24iKQogICAgICAgICAgICAgICAgICAgIGtsID0gX2V4dHJhY3QobGVnYWN5X3Njb3JlcywgImtleV9sZXZlbHMiKQogICAgICAgICAgICAgICAgICAgIG1vbSA9IF9leHRyYWN0KGxlZ2FjeV9zY29yZXMsICJtb21lbnR1bSIpCiAgICAgICAgICAgICAgICAgICAgc3RydSA9IF9leHRyYWN0KGxlZ2FjeV9zY29yZXMsICJzdHJ1Y3R1cmUiKQogICAgICAgICAgICAgICAgICAgIHByaW50KGYiICAgICBQQTp7cGE6Ky4yZn0gIEtMOntrbDorLjJmfSAgTU9NOnttb206Ky4yZn0gIFNUUjp7c3RydTorLjJmfSIpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHNlbGYuX3NhdmVfZXJyb3Jfcm93KHRpbWVmcmFtZSwgbm93X2lzbywgbDJfZWxhcHNlZF9tcywgIkFQSV9FUlJPUiIpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZWxpZiBub3Qgc2VsZi5jbGllbnQ6CiAgICAgICAgICAgIGxvZ2dpbmcuZXJyb3IoIiAgTm8gQVBJIGNsaWVudCDigJQgdXNpbmcgTDEgb25seSIpCgogICAgICAgICMg4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQCiAgICAgICAgIyBCTEVORDogODAlIExheWVyIDEgKyAyMCUgTGF5ZXIgMiBBZGp1c3RtZW50CiAgICAgICAgIyDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZAKICAgICAgICBlbGFwc2VkX21zID0gbDFfbXMgKyBsMl9lbGFwc2VkX21zCgogICAgICAgIGlmIGwxOgogICAgICAgICAgICAjIFN0YXJ0IHdpdGggTDEgYmFzZSBzY29yZXMKICAgICAgICAgICAgcGEgPSBsMVsncHJpY2VfYWN0aW9uJ11bJ3Njb3JlJ10KICAgICAgICAgICAga2wgPSBsMVsna2V5X2xldmVscyddWydzY29yZSddCiAgICAgICAgICAgIG1vbSA9IGwxWydtb21lbnR1bSddWydzY29yZSddCiAgICAgICAgICAgIHN0cnUgPSBsMVsnc3RydWN0dXJlJ11bJ3Njb3JlJ10KCiAgICAgICAgICAgIGlmIGwyOgogICAgICAgICAgICAgICAgIyBCbGVuZDogd2VpZ2h0ZWQgc3VtIG9mIEwxIGJhc2UgKyBMMiBhZGp1c3RtZW50CiAgICAgICAgICAgICAgICBMMV9XRUlHSFQgPSAwLjgwCiAgICAgICAgICAgICAgICBMMl9XRUlHSFQgPSAwLjIwCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHBhX2FkaiA9IGwyLmdldCgncHJpY2VfYWN0aW9uJywge30pLmdldCgnYWRqdXN0bWVudCcsIDApCiAgICAgICAgICAgICAgICBrbF9hZGogPSBsMi5nZXQoJ2tleV9sZXZlbHMnLCB7fSkuZ2V0KCdhZGp1c3RtZW50JywgMCkKICAgICAgICAgICAgICAgIG1vbV9hZGogPSBsMi5nZXQoJ21vbWVudHVtJywge30pLmdldCgnYWRqdXN0bWVudCcsIDApCiAgICAgICAgICAgICAgICBzdHJfYWRqID0gbDIuZ2V0KCdzdHJ1Y3R1cmUnLCB7fSkuZ2V0KCdhZGp1c3RtZW50JywgMCkKCiAgICAgICAgICAgICAgICBwYSA9IG1heCgtMS4wLCBtaW4oMS4wLCBwYSAqIEwxX1dFSUdIVCArIHBhX2FkaiAqIEwyX1dFSUdIVCArIHBhICogTDJfV0VJR0hUKSkKICAgICAgICAgICAgICAgIGtsID0gbWF4KC0xLjAsIG1pbigxLjAsIGtsICogTDFfV0VJR0hUICsga2xfYWRqICogTDJfV0VJR0hUICsga2wgKiBMMl9XRUlHSFQpKQogICAgICAgICAgICAgICAgbW9tID0gbWF4KC0xLjAsIG1pbigxLjAsIG1vbSAqIEwxX1dFSUdIVCArIG1vbV9hZGogKiBMMl9XRUlHSFQgKyBtb20gKiBMMl9XRUlHSFQpKQogICAgICAgICAgICAgICAgc3RydSA9IG1heCgtMS4wLCBtaW4oMS4wLCBzdHJ1ICogTDFfV0VJR0hUICsgc3RyX2FkaiAqIEwyX1dFSUdIVCArIHN0cnUgKiBMMl9XRUlHSFQpKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBzb3VyY2VfdHlwZSA9ICJMMStMMiIKICAgICAgICAgICAgICAgIHByaW50KGYiICBcVTAwMDFmNTAwIEJsZW5kZWQgKDgwLzIwKToiKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgIyBMMSBvbmx5IChubyBMMiBhdmFpbGFibGUpCiAgICAgICAgICAgICAgICBzb3VyY2VfdHlwZSA9ICJMMV9PTkxZIgogICAgICAgICAgICAgICAgcHJpbnQoZiIgIFxVMDAwMWY1MDAgTDEgT25seSAobm8gTDIpOiIpCiAgICAgICAgICAgIAogICAgICAgICAgICBwcmludChmIiAgICAgUEE6e3BhOisuM2Z9ICBLTDp7a2w6Ky4zZn0gIE1PTTp7bW9tOisuM2Z9ICBTVFI6e3N0cnU6Ky4zZn0iKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgICMgTGVnYWN5IGZhbGxiYWNrIOKAlCBwYS9rbC9tb20vc3RydSBhbHJlYWR5IHNldCBmcm9tIGxlZ2FjeSBzY29yaW5nIGFib3ZlCiAgICAgICAgICAgIHNvdXJjZV90eXBlID0gIkxFR0FDWSIKICAgICAgICAgICAgcHJpbnQoZiIgIFxVMDAwMWY1MDAgTGVnYWN5IHNjb3JlczogUEE6e3BhOisuMmZ9ICBLTDp7a2w6Ky4yZn0gIE1PTTp7bW9tOisuMmZ9ICBTVFI6e3N0cnU6Ky4yZn0iKQoKICAgICAgICAjIOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkAogICAgICAgICMgQVRIIFNjb3JlIChkZXRlcm1pbmlzdGljLCBmcm9tIGludGVsbGlnZW5jZSBEQikKICAgICAgICAjIOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkAogICAgICAgIGF0aF9yZXN1bHQgPSBjYWxjdWxhdGVfYXRoX3Njb3JlKHNlbGYuc3ltYm9sKQogICAgICAgIGF0aF9zY29yZSA9IGF0aF9yZXN1bHQuZ2V0KCJzY29yZSIsIDAuMCkKICAgICAgICBwcmludChmIiAgXFUwMDAxZjRjYSBBVEg6IHthdGhfc2NvcmU6Ky4yZn0gKHthdGhfcmVzdWx0LmdldCgncGVyY2VudGlsZScsIDUwKTouMGZ9dGggcGN0bCwgIgogICAgICAgICAgICAgIGYie2F0aF9yZXN1bHQuZ2V0KCd6b25lJywgJz8nKX0pIikKCiAgICAgICAgIyDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZAKICAgICAgICAjIFNBVkUgdG8gREIg4oaSIERCIGFwcGxpZXMgd2VpZ2h0cywgYmxlbmRzIGNvbnNlbnN1cywgZGVjaWRlcwogICAgICAgICMg4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQCiAgICAgICAgc2VudGltZW50X2RhdGEgPSB7CiAgICAgICAgICAgICJwcm9maWxlX2lkIjogICAgICAgICAgc2VsZi5wcm9maWxlLmlkLAogICAgICAgICAgICAic3ltYm9sIjogICAgICAgICAgICAgIHNlbGYuc3ltYm9sLAogICAgICAgICAgICAidGltZWZyYW1lIjogICAgICAgICAgIHRpbWVmcmFtZSwKICAgICAgICAgICAgInRpbWVzdGFtcCI6ICAgICAgICAgICBub3dfaXNvLAogICAgICAgICAgICAicHJpY2VfYWN0aW9uX3Njb3JlIjogIHBhLAogICAgICAgICAgICAia2V5X2xldmVsc19zY29yZSI6ICAgIGtsLAogICAgICAgICAgICAibW9tZW50dW1fc2NvcmUiOiAgICAgIG1vbSwKICAgICAgICAgICAgImF0aF9zY29yZSI6ICAgICAgICAgICBhdGhfc2NvcmUsCiAgICAgICAgICAgICJzdHJ1Y3R1cmVfc2NvcmUiOiAgICAgc3RydSwKICAgICAgICAgICAgInNvdXJjZV9tb2RlbCI6ICAgICAgICBzZWxmLm1vZGVsLAogICAgICAgICAgICAic291cmNlX3R5cGUiOiAgICAgICAgIHNvdXJjZV90eXBlLAogICAgICAgICAgICAicHJvY2Vzc2luZ190aW1lX21zIjogIGVsYXBzZWRfbXMsCiAgICAgICAgfQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIHJlYWRpbmdfaWQgPSBzZWxmLmRiLnNhdmVfc2VudGltZW50KHNlbGYuaW5zdGFuY2VfaWQsIHNlbnRpbWVudF9kYXRhLCBzZWxmLnByb2ZpbGUpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBsb2dnaW5nLmVycm9yKGYiICBcVTAwMDFmNGJlIERCIHNhdmUgRkFJTEVEOiB7ZX0g4oCUIHJlZnVzaW5nIHRvIHRyYWRlIikKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgICMg4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQCiAgICAgICAgIyBSZWFkIFZlcmRpY3QgZnJvbSBEQgogICAgICAgICMg4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQCiAgICAgICAgdmVyZGljdCA9IHNlbGYuZGIuZ2V0X2xhdGVzdF9zZW50aW1lbnQoc2VsZi5pbnN0YW5jZV9pZCwgdGltZWZyYW1lKQogICAgICAgIGlmIG5vdCB2ZXJkaWN0OgogICAgICAgICAgICBsb2dnaW5nLmVycm9yKCIgIFxVMDAwMWY0ZDYgQ291bGQgbm90IHJlYWQgdmVyZGljdCBmcm9tIERCIikKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGNvbnNlbnN1cyA9IHZlcmRpY3QuZ2V0KCJjb25zZW5zdXNfc2NvcmUiLCAwKQogICAgICAgIG1lZXRzID0gdmVyZGljdC5nZXQoIm1lZXRzX3RocmVzaG9sZCIsIDApCiAgICAgICAgZGlyZWN0aW9uID0gdmVyZGljdC5nZXQoInNpZ25hbF9kaXJlY3Rpb24iLCAiSE9MRCIpCiAgICAgICAgY29tcG9zaXRlID0gdmVyZGljdC5nZXQoImNvbXBvc2l0ZV9zY29yZSIsIDApCiAgICAgICAgcGFydG5lciA9IHZlcmRpY3QuZ2V0KCJwYXJ0bmVyX2NvbXBvc2l0ZSIpCgogICAgICAgIHByaW50KGYiICBcVTAwMDFmNGJlIERCIHZlcmRpY3Q6IGNvbXBvc2l0ZT17Y29tcG9zaXRlOisuM2Z9IHwgIgogICAgICAgICAgICAgIGYicGFydG5lcj17cGFydG5lciBpZiBwYXJ0bmVyIGlzIG5vdCBOb25lIGVsc2UgJ04vQSd9IHwgIgogICAgICAgICAgICAgIGYiY29uc2Vuc3VzPXtjb25zZW5zdXM6Ky4zZn0iKQoKICAgICAgICBlbW9qaSA9IHsiQlVZIjogIlxVMDAwMWY3ZTIiLCAiU0VMTCI6ICJcVTAwMDFmNTM0IiwgIkhPTEQiOiAiXHUyNmFhIn0uZ2V0KGRpcmVjdGlvbiwgIlx1MjZhYSIpCiAgICAgICAgc3RhdHVzID0gIk1FVCBcdTI3MTMiIGlmIG1lZXRzIGVsc2UgIk5PVCBNRVQgXHUwMGI3IgogICAgICAgIHByaW50KGYiICB7ZW1vaml9IHtkaXJlY3Rpb259IHwgdGhyZXNob2xkOiB7c3RhdHVzfSIpCgogICAgICAgICMg4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQCiAgICAgICAgIyBFeGVjdXRlIGlmIG1lZXRzX3RocmVzaG9sZAogICAgICAgICMg4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQCiAgICAgICAgaWYgbWVldHMgYW5kIGRpcmVjdGlvbiBpbiAoIkJVWSIsICJTRUxMIik6CiAgICAgICAgICAgIHNlbGYuX2V4ZWN1dGVfc2lnbmFsKGRpcmVjdGlvbikKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludChmIiAgXHUyM2Y4XHVmZTBmICBObyBzaWduYWwg4oCUIGhvbGRpbmciKQoKICAgIGRlZiBfc2F2ZV9lcnJvcl9yb3coc2VsZiwgdGltZWZyYW1lOiBzdHIsIHRpbWVzdGFtcDogc3RyLCBlbGFwc2VkX21zOiBpbnQsIGVycm9yX3R5cGU6IHN0cik6CiAgICAgICAgIiIiU2F2ZSBhIHBhcnRpYWwgc2VudGltZW50IHJvdyBvbiBBUEkvc2NyZWVuc2hvdCBmYWlsdXJlLiIiIgogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5kYi5zYXZlX3NlbnRpbWVudChzZWxmLmluc3RhbmNlX2lkLCB7CiAgICAgICAgICAgICAgICAicHJvZmlsZV9pZCI6ICAgICAgICAgc2VsZi5wcm9maWxlLmlkLAogICAgICAgICAgICAgICAgInN5bWJvbCI6ICAgICAgICAgICAgIHNlbGYuc3ltYm9sLAogICAgICAgICAgICAgICAgInRpbWVmcmFtZSI6ICAgICAgICAgIHRpbWVmcmFtZSwKICAgICAgICAgICAgICAgICJ0aW1lc3RhbXAiOiAgICAgICAgICB0aW1lc3RhbXAsCiAgICAgICAgICAgICAgICAicHJpY2VfYWN0aW9uX3Njb3JlIjogMCwgImtleV9sZXZlbHNfc2NvcmUiOiAwLAogICAgICAgICAgICAgICAgIm1vbWVudHVtX3Njb3JlIjogMCwgImF0aF9zY29yZSI6IDAsICJzdHJ1Y3R1cmVfc2NvcmUiOiAwLAogICAgICAgICAgICAgICAgInNvdXJjZV9tb2RlbCI6ICAgICAgIHNlbGYubW9kZWwsCiAgICAgICAgICAgICAgICAic291cmNlX3R5cGUiOiAgICAgICAgZXJyb3JfdHlwZSwKICAgICAgICAgICAgICAgICJwcm9jZXNzaW5nX3RpbWVfbXMiOiBlbGFwc2VkX21zLAogICAgICAgICAgICB9LCBzZWxmLnByb2ZpbGUpCiAgICAgICAgICAgIHByaW50KGYiICDwn5K+IFNhdmVkIGVycm9yIHJvdyAoe2Vycm9yX3R5cGV9KSDigJQgc2lnbmFsOiBIT0xEIikKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGxvZ2dpbmcuZXJyb3IoZiIgIEVycm9yIHJvdyBzYXZlIGFsc28gZmFpbGVkOiB7ZX0iKQoKICAgIGRlZiBfcmVsb2FkX2NvbmZpZyhzZWxmKToKICAgICAgICAiIiJIb3QtcmVsb2FkIHRyYWRpbmcgY29uZmlnIGZyb20gREIgcHJvZmlsZSAoU2VlZCAyMEM6IGxpdmUgY29uZmlnKS4iIiIKICAgICAgICB0cnk6CiAgICAgICAgICAgIHByb2ZpbGUgPSBzZWxmLmRiLmdldF9wcm9maWxlKHNlbGYucHJvZmlsZS5pZCkKICAgICAgICAgICAgaWYgcHJvZmlsZSBhbmQgcHJvZmlsZS50cmFkaW5nX2NvbmZpZzoKICAgICAgICAgICAgICAgIGltcG9ydCBqc29uIGFzIF9qc29uCiAgICAgICAgICAgICAgICB0YyA9IF9qc29uLmxvYWRzKHByb2ZpbGUudHJhZGluZ19jb25maWcpIGlmIGlzaW5zdGFuY2UocHJvZmlsZS50cmFkaW5nX2NvbmZpZywgc3RyKSBlbHNlIHByb2ZpbGUudHJhZGluZ19jb25maWcKICAgICAgICAgICAgICAgIGlmIHRjIGFuZCB0Yy5nZXQoJ3RocmVzaG9sZHMnKToKICAgICAgICAgICAgICAgICAgICBzZWxmLnRjID0gdGMKICAgICAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgbG9nZ2luZy53YXJuaW5nKGYiQ29uZmlnIHJlbG9hZCBmYWlsZWQgKHVzaW5nIGNhY2hlZCk6IHtlfSIpCiAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgZGVmIF9leGVjdXRlX3NpZ25hbChzZWxmLCBkaXJlY3Rpb246IHN0cik6CiAgICAgICAgIiIiUmF0ZS1saW1pdCBjaGVjayDihpIgd3JpdGUgc2lnbmFsIHRvIE1UNS4iIiIKICAgICAgICBzZWxmLl9yZXNldF9ob3VybHkoKQogICAgICAgIHJpc2sgPSBzZWxmLnRjLmdldCgncmlzaycsIHt9KQogICAgICAgIG1heF9zaWdzID0gcmlzay5nZXQoJ21heF9zaWduYWxzX3Blcl9ob3VyJywgMykKICAgICAgICBjb29sZG93biA9IHJpc2suZ2V0KCdjb29sZG93bl9zZWNvbmRzJywgMzAwKQoKICAgICAgICAjIFJhdGUgbGltaXQKICAgICAgICBpZiBzZWxmLl9zaWduYWxzX3RoaXNfaG91ciA+PSBtYXhfc2lnczoKICAgICAgICAgICAgcHJpbnQoZiIgIPCfmqsgUmF0ZSBsaW1pdDoge3NlbGYuX3NpZ25hbHNfdGhpc19ob3VyfS97bWF4X3NpZ3N9IHRoaXMgaG91ciIpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICAjIENvb2xkb3duCiAgICAgICAgaWYgc2VsZi5fbGFzdF9zaWduYWxfdGltZToKICAgICAgICAgICAgZWxhcHNlZCA9IChkYXRldGltZS5ub3coKSAtIHNlbGYuX2xhc3Rfc2lnbmFsX3RpbWUpLnRvdGFsX3NlY29uZHMoKQogICAgICAgICAgICBpZiBlbGFwc2VkIDwgY29vbGRvd246CiAgICAgICAgICAgICAgICBwcmludChmIiAg4o+zIENvb2xkb3duOiB7Y29vbGRvd24gLSBlbGFwc2VkOi4wZn1zIHJlbWFpbmluZyIpCiAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAgIyBSZXNvbHZlIE1UNSBzeW1ib2wKICAgICAgICBzeW1fY29uZmlnID0gU1lNQk9MX0RBVEFCQVNFUy5nZXQoc2VsZi5zeW1ib2wsIHt9KQogICAgICAgIG10NV9zeW1ib2wgPSBzeW1fY29uZmlnLmdldCgic3ltYm9sIiwgc2VsZi5zeW1ib2wgKyAiLnNpbSIpCiAgICAgICAgbG90X3NpemUgPSByaXNrLmdldCgnYmFzZV9sb3RzJywgMS4wKQoKICAgICAgICBjb21tZW50ID0gKGYiVE9SUkF8e2RpcmVjdGlvbn18e3NlbGYuaW5zdGFuY2VfaWRbOjIwXX18aXRlcntzZWxmLl9pdGVyYXRpb259IikKCiAgICAgICAgd3JpdHRlbiA9IHdyaXRlX3NpZ25hbCgKICAgICAgICAgICAgcGF0aD1zZWxmLnNpZ25hbF9wYXRoLAogICAgICAgICAgICBhY3Rpb249ZGlyZWN0aW9uLAogICAgICAgICAgICBzeW1ib2w9bXQ1X3N5bWJvbCwKICAgICAgICAgICAgcXR5PWxvdF9zaXplLAogICAgICAgICAgICBzbD0wLCAgICMgRUEgaGFuZGxlcyBTTC9UUCDigJQgd2UgZG9uJ3QgaGF2ZSBsaXZlIHByaWNlCiAgICAgICAgICAgIHRwPTAsCiAgICAgICAgICAgIGNvbW1lbnQ9Y29tbWVudAogICAgICAgICkKCiAgICAgICAgaWYgd3JpdHRlbjoKICAgICAgICAgICAgc2VsZi5fc2lnbmFsc190aGlzX2hvdXIgKz0gMQogICAgICAgICAgICBzZWxmLl9sYXN0X3NpZ25hbF90aW1lID0gZGF0ZXRpbWUubm93KCkKICAgICAgICAgICAgcHJpbnQoZiIgIOKchSBTSUdOQUwg4oaSIE1UNToge2RpcmVjdGlvbn0ge2xvdF9zaXplfSB7bXQ1X3N5bWJvbH0iKQoKICAgICMg4pSA4pSA4pSAIFJ1biBNb2RlcyDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAKCiAgICBkZWYgcnVuX29uY2Uoc2VsZiwgdGltZWZyYW1lOiBzdHIgPSAiMTVtIik6CiAgICAgICAgIiIiU2luZ2xlIHRpY2sgZm9yIHRlc3RpbmcuIiIiCiAgICAgICAgc2VsZi5fdGljayh0aW1lZnJhbWUpCgogICAgZGVmIHJ1bl9sb29wKHNlbGYsIHJ1bl9ub3c9RmFsc2UpOgogICAgICAgICIiIk1haW4gbG9vcCDigJQgZm9sbG93cyBzZW50aW1lbnQgZW5naW5lIHNjaGVkdWxlLiIiIgogICAgICAgIGRlZiBoYW5kbGVfc2h1dGRvd24oc2lnbnVtLCBmcmFtZSk6CiAgICAgICAgICAgIGxvZ2dpbmcuaW5mbyhmIlJlY2VpdmVkIHNpZ25hbCB7c2lnbnVtfSwgc2h1dHRpbmcgZG93bi4uLiIpCiAgICAgICAgICAgIHNlbGYuX3NodXRkb3duID0gVHJ1ZQoKICAgICAgICBzaWduYWwuc2lnbmFsKHNpZ25hbC5TSUdURVJNLCBoYW5kbGVfc2h1dGRvd24pCiAgICAgICAgc2lnbmFsLnNpZ25hbChzaWduYWwuU0lHSU5ULCBoYW5kbGVfc2h1dGRvd24pCgogICAgICAgIHByaW50KGYiXG4gIFNjaGVkdWxlOiAgMTVtQHtTQ0hFRFVMRV8xNU19IHwgMWhAe1NDSEVEVUxFXzFIfSIpCiAgICAgICAgCiAgICAgICAgIyBTZWVkIDE4OiAtLXJ1bi1ub3cgZG9lcyBhbiBpbW1lZGlhdGUgMTVtIHRpY2sgb24gYWN0aXZhdGlvbgogICAgICAgIGlmIHJ1bl9ub3c6CiAgICAgICAgICAgIHByaW50KCIgIPCfmoAgSW1tZWRpYXRlIGZpcnN0IHRpY2sgKC0tcnVuLW5vdykuLi4iKQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzZWxmLl90aWNrKCIxNW0iKQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBsb2dnaW5nLmVycm9yKGYiICDinJcgSW1tZWRpYXRlIHRpY2sgZmFpbGVkIChub24tZmF0YWwpOiB7ZX0iKQogICAgICAgICAgICAgICAgcHJpbnQoZiIgIOKclyBJbW1lZGlhdGUgdGljayBlcnJvcjoge2V9IOKAlCBlbnRlcmluZyBzY2hlZHVsZSBsb29wIikKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludCgiICBXYWl0aW5nIGZvciBuZXh0IHNjaGVkdWxlZCB0aWNrLi4uIikKICAgICAgICBwcmludCgpCgogICAgICAgIHRyeToKICAgICAgICAgICAgd2hpbGUgbm90IHNlbGYuX3NodXRkb3duOgogICAgICAgICAgICAgICAgZGlkX3NvbWV0aGluZyA9IEZhbHNlCgogICAgICAgICAgICAgICAgaWYgc2VsZi5faXNfMTVtX3RpY2soKToKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3RpY2soIjE1bSIpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgICAgICAgICBsb2dnaW5nLmVycm9yKGYiICDinJcgMTVtIFRJQ0sgRkFJTEVEIChub24tZmF0YWwpOiB7ZX0iKQogICAgICAgICAgICAgICAgICAgICAgICBwcmludChmIiAg4pyXIDE1bSB0aWNrIGVycm9yOiB7ZX0g4oCUIHRyYWRlciBjb250aW51ZXMiKQogICAgICAgICAgICAgICAgICAgIGRpZF9zb21ldGhpbmcgPSBUcnVlCgogICAgICAgICAgICAgICAgaWYgc2VsZi5faXNfMWhfdGljaygpOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fdGljaygiMWgiKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2luZy5lcnJvcihmIiAg4pyXIDFoIFRJQ0sgRkFJTEVEIChub24tZmF0YWwpOiB7ZX0iKQogICAgICAgICAgICAgICAgICAgICAgICBwcmludChmIiAg4pyXIDFoIHRpY2sgZXJyb3I6IHtlfSDigJQgdHJhZGVyIGNvbnRpbnVlcyIpCiAgICAgICAgICAgICAgICAgICAgZGlkX3NvbWV0aGluZyA9IFRydWUKCiAgICAgICAgICAgICAgICBpZiBub3QgZGlkX3NvbWV0aGluZzoKICAgICAgICAgICAgICAgICAgICBub3cgPSBkYXRldGltZS5ub3coKQogICAgICAgICAgICAgICAgICAgIGlmIG5vdy5zZWNvbmQgPCAxMCBhbmQgbm93Lm1pbnV0ZSAlIDUgPT0gMDoKICAgICAgICAgICAgICAgICAgICAgICAgbmV4dF8xNW0gPSBtaW4oKG0gZm9yIG0gaW4gU0NIRURVTEVfMTVNIGlmIG0gPiBub3cubWludXRlKSwgZGVmYXVsdD1TQ0hFRFVMRV8xNU1bMF0pCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGYiICDwn5KTIHtub3cuc3RyZnRpbWUoJyVIOiVNJyl9IOKAlCB3YWl0aW5nIChuZXh0IDE1bSB0aWNrIGF0IDp7bmV4dF8xNW06MDJkfSkiKQoKICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMTApCgogICAgICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDoKICAgICAgICAgICAgcGFzcwogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgIyBDYXRjaCBBTlkgZXJyb3IgdGhhdCBlc2NhcGVzIHRoZSBsb29wIGJvZHkKICAgICAgICAgICAgbG9nZ2luZy5lcnJvcihmIiAgRkFUQUwgTE9PUCBFUlJPUjoge3R5cGUoZSkuX19uYW1lX199OiB7ZX0iKQogICAgICAgICAgICBpbXBvcnQgdHJhY2ViYWNrCiAgICAgICAgICAgIHRyYWNlYmFjay5wcmludF9leGMoKQogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIHByaW50KGYiXG57J+KVkCcqNjB9IikKICAgICAgICAgICAgcHJpbnQoZiIgIFRPUlJBIFRSQURFUiBTVE9QUEVEIOKAlCB7c2VsZi5faXRlcmF0aW9ufSBpdGVyYXRpb25zIikKICAgICAgICAgICAgcHJpbnQoZiJ7J+KVkCcqNjB9IikKCgojIOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkAojIENMSQojIOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkAoKZGVmIG1haW4oKToKICAgIGxvZ2dpbmcuYmFzaWNDb25maWcobGV2ZWw9bG9nZ2luZy5JTkZPLCBmb3JtYXQ9TE9HX0ZPUk1BVCkKCiAgICBwYXJzZXIgPSBhcmdwYXJzZS5Bcmd1bWVudFBhcnNlcihkZXNjcmlwdGlvbj0iVE9SUkEgVHJhZGVyIHYyLjAg4oCUIENvbmZpZy1GaXJzdCBFeGVjdXRvciIpCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItLWluc3RhbmNlLWlkIiwgaGVscD0iSW5zdGFuY2UgSUQgZnJvbSBpbnN0YW5jZSBkYXRhYmFzZSIpCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItLXN5bWJvbCIsIGhlbHA9IlN5bWJvbCAoaWYgLS1hdXRvLWNyZWF0ZSkiKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1hdXRvLWNyZWF0ZSIsIGFjdGlvbj0ic3RvcmVfdHJ1ZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIGhlbHA9IkF1dG8tY3JlYXRlIGluc3RhbmNlIGlmIC0tc3ltYm9sIGdpdmVuIHdpdGhvdXQgLS1pbnN0YW5jZS1pZCIpCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItLW9uY2UiLCBhY3Rpb249InN0b3JlX3RydWUiLCBoZWxwPSJTaW5nbGUgdGljaywgbm8gbG9vcCIpCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItLXJ1bi1ub3ciLCBhY3Rpb249InN0b3JlX3RydWUiLAogICAgICAgICAgICAgICAgICAgICAgICBoZWxwPSJSdW4gYW4gaW1tZWRpYXRlIDE1bSB0aWNrIG9uIHN0YXJ0dXAsIHRoZW4gZm9sbG93IHNjaGVkdWxlIikKICAgIHBhcnNlci5hZGRfYXJndW1lbnQoIi0tdGltZWZyYW1lIiwgZGVmYXVsdD0iMTVtIiwgY2hvaWNlcz1bIjE1bSIsICIxaCJdLAogICAgICAgICAgICAgICAgICAgICAgICBoZWxwPSJUaW1lZnJhbWUgZm9yIC0tb25jZSBtb2RlIikKICAgIHBhcnNlci5hZGRfYXJndW1lbnQoIi0tc2lnbmFsLXBhdGgiLCBkZWZhdWx0PURFRkFVTFRfU0lHTkFMX1BBVEgpCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItLWRiLXBhdGgiLCBkZWZhdWx0PU5vbmUpCgogICAgYXJncyA9IHBhcnNlci5wYXJzZV9hcmdzKCkKCiAgICBpbnN0YW5jZV9pZCA9IGFyZ3MuaW5zdGFuY2VfaWQKCiAgICBpZiBub3QgaW5zdGFuY2VfaWQgYW5kIGFyZ3Muc3ltYm9sIGFuZCBhcmdzLmF1dG9fY3JlYXRlOgogICAgICAgIGRiX3BhdGggPSBhcmdzLmRiX3BhdGggb3Igb3MucGF0aC5qb2luKEJBU0VfRElSLCAiYXBleF9pbnN0YW5jZXMuZGIiKQogICAgICAgIGRiID0gZ2V0X2luc3RhbmNlX2RiKGRiX3BhdGgpCiAgICAgICAgaW5zdCA9IGRiLmNyZWF0ZV9pbnN0YW5jZShhcmdzLnN5bWJvbC51cHBlcigpLCAiU0lNIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlfbmFtZT1mInthcmdzLnN5bWJvbC51cHBlcigpfSBUT1JSQSB2MiIpCiAgICAgICAgaW5zdGFuY2VfaWQgPSBpbnN0LmlkCiAgICAgICAgcHJpbnQoZiLinJMgQXV0by1jcmVhdGVkIGluc3RhbmNlOiB7aW5zdGFuY2VfaWR9IikKCiAgICBpZiBub3QgaW5zdGFuY2VfaWQ6CiAgICAgICAgcGFyc2VyLmVycm9yKCJQcm92aWRlIC0taW5zdGFuY2UtaWQgb3IgLS1zeW1ib2wgd2l0aCAtLWF1dG8tY3JlYXRlIikKCiAgICB0cnk6CiAgICAgICAgdHJhZGVyID0gVG9ycmFUcmFkZXIoaW5zdGFuY2VfaWQsIGRiX3BhdGg9YXJncy5kYl9wYXRoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25hbF9wYXRoPWFyZ3Muc2lnbmFsX3BhdGgpCgogICAgICAgIGlmIGFyZ3Mub25jZToKICAgICAgICAgICAgdHJhZGVyLnJ1bl9vbmNlKGFyZ3MudGltZWZyYW1lKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHRyYWRlci5ydW5fbG9vcChydW5fbm93PWFyZ3MucnVuX25vdykKICAgIGV4Y2VwdCBTeXN0ZW1FeGl0OgogICAgICAgIHJhaXNlICAjIExldCBjb25maWcgdmFsaWRhdGlvbiBzeXMuZXhpdCgxKSBwcm9wYWdhdGUKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBsb2dnaW5nLmVycm9yKGYiXG57Jz0nKjYwfSIpCiAgICAgICAgbG9nZ2luZy5lcnJvcihmIiAgRkFUQUw6IFVuaGFuZGxlZCBleGNlcHRpb24gY3Jhc2hlZCB0aGUgdHJhZGVyIikKICAgICAgICBsb2dnaW5nLmVycm9yKGYiICB7dHlwZShlKS5fX25hbWVfX306IHtlfSIpCiAgICAgICAgbG9nZ2luZy5lcnJvcihmInsnPScqNjB9IikKICAgICAgICBpbXBvcnQgdHJhY2ViYWNrCiAgICAgICAgdHJhY2ViYWNrLnByaW50X2V4YygpCiAgICAgICAgc3lzLmV4aXQoMikKCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgbWFpbigpCg==")
path = os.path.join(r"C:\Users\colli\Downloads\#CodeBase", "torra_trader.py")
with open(path, "wb") as f:
    f.write(data)
print(f"Written torra_trader.py: {len(data)} bytes")
